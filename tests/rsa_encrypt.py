import rsa
import random
import string

def get_random_string(length):
    letters = string.ascii_uppercase
    result_str = ''.join(random.choice(letters) for i in range(length))
    return result_str

public_key_str = "3082010a0282010100879f57013dfce149cebc460171d5d35db0e76559af2d60736e10aecb6a9c9d1e4afed4bb5817faf29b321d488a3cac43be13a3ffe6d9270a208b667e58fb5e910977da79a40e9f19d0c111d140541df511aef5bfaee0daca6118403fea0c8aaff21a38fc5412cbec7886355a4160775237716d6cfb2ee5aa53e29b19856a1471ea63921dcef38fdf38f8a8667ded4420a2b737e776f85f417a251090d9c7c14a39dcdb1464d0b6c6214c891b4521503925e3a00a7ba7b00ce767e6835cc08ddc1b116ca73f7ff0c08cb9419e06b79911b587d240c613754529f21f0b4b231012ef80f2973a4d8c50b5c0ebea1cff19fa49ac1fd200ec254b4001e8ecbe0fa6730203010001"
public_key = bytes.fromhex(public_key_str)

pubkey = rsa.PublicKey._load_pkcs1_der(public_key)

aes256_random_key = get_random_string(32).encode('utf8')
print('secret key: ', aes256_random_key.decode('utf-8'))
ciphered = rsa.encrypt(aes256_random_key, pubkey)

print('ciphered secret key: ', ciphered.hex())

private_key_str = "308204a90201000282010100879f57013dfce149cebc460171d5d35db0e76559af2d60736e10aecb6a9c9d1e4afed4bb5817faf29b321d488a3cac43be13a3ffe6d9270a208b667e58fb5e910977da79a40e9f19d0c111d140541df511aef5bfaee0daca6118403fea0c8aaff21a38fc5412cbec7886355a4160775237716d6cfb2ee5aa53e29b19856a1471ea63921dcef38fdf38f8a8667ded4420a2b737e776f85f417a251090d9c7c14a39dcdb1464d0b6c6214c891b4521503925e3a00a7ba7b00ce767e6835cc08ddc1b116ca73f7ff0c08cb9419e06b79911b587d240c613754529f21f0b4b231012ef80f2973a4d8c50b5c0ebea1cff19fa49ac1fd200ec254b4001e8ecbe0fa6730203010001028201000f886e5c940eec769998f2a3a3b80bb745559b44044e3c27bc4968db9f6044967d9c661cf6dff83be50e7e501a950c5dcddd4e01371d53dd5310e432405ab9dffea79d7c25100fa4d345e9967fb9a29cb8e3c2fdab37d197303ba8d0292c3a8e203a64a071b89d667dff5108ff47df22a97af23f731d51ec7a6c0a18d23150825b3fb49375799b99df33e0c0077b856eaa8747a977a7562de12cbf415a18a25746a09e87a3361056f5bebc41af120221f2d1bfc5498f02768052b98210fe14a45995a0cb68af179a70f2dcea0087e0b5b3e5288abb1cfea2cfa506f9430fbace9ef0b43057995bd9c02288f6bd749e53b90d453142f77c1f29291322ca45ca110281890089359a2eff82685b69f186af70826dfc03f0490b9beb75b944a29f2b9c10a57e79a3bea7d6c3937e9debb625b7963ce413f8411229de2729e1e03cd19ded0b4ae1d62c92b3271a0bc162ba33901d25a32f2a06f007fc592e32516369cfe3bd5b499590769be923050aa9d790784178743b61d50d329b8ea3579753c26f2131c908c629c6269e6c6f027900fd0a02dcd1a6c7b66d39b28f8a6331fa6987c912c79aa3ce2b0df56136af9c916c2788c12a6a7a4d3cedf2e8e04f9e39e96c8e7645de4a767065d568c9f8b6bc366df246f20c4fba6da0d434e6c7a2a355e58179660039194b3fe8b7e97be55ef7df38ecee5df5545fefe2d35531ea12c81b9bd24d35303d0281886f79822bdee11761f5a009f9ed61ba73becb70bd22cf5914cd8385e80b62a6e22b777285b001b38a724937f24ac69feff99d7f587f7582c20f467c831d58a20d13904b2460b34b00f3fbff25b75746e5de82b9a2380ab875c4e1c4f009bb90736344455b67ee30ca7ed060577aac4e6db87512802776a49b66a586a2786132ae8f17588729871ab7027900b9f92ca76cf2fe1f66e19c0a0174ec5b964a350f3762c1779a8f34c49133ba87eb0c9767192c8edccba63afccb37d91bc9227f06104dd33e7f5768e50e645cb1b1f356b8abd73e95cf5300042d85965423a27d6962fd50f9f523708012fb7b5634297ca62e7f21fb345393cb2cf77588fe47c45b696169250281884b9e3dbbda0c65a8dee150744edcd71b387deda3a181456d0508019a1c8ffda77097508763760168655015982bec4b2ed67a4c04cc006fe6beaf8f306042d82e17c0cb9649326ad246d4d67db7de56893ab8d2788dbcceaeb4434f8ea09fd4aefc651c41c6045f8a0444ad7445b4d1286b82564150d360c4d1ad1f25a41b83390594ecdbd4edd158"
private_key = bytes.fromhex(private_key_str)

prvkey = rsa.PrivateKey._load_pkcs1_der(private_key)

plaintext = rsa.decrypt(ciphered, prvkey)
print(plaintext.decode('utf-8'))









